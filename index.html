<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HeyGen Embed</title>
  </head>
  <body>
    <script>
      !function(window){
        const host = "https://labs.heygen.com";
        const url = host + "/guest/streaming-embed?share=eyJxdWFsaXR5Ijoi...";
        const container = document.createElement("div");
        container.id = "heygen-streaming-container";
        const stylesheet = document.createElement("style");
        stylesheet.innerHTML = `
          #heygen-streaming-embed {
            z-index: 9999;
            position: fixed;
            left: 40px;
            bottom: 40px;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 2px solid #fff;
            box-shadow: 0px 8px 24px rgba(0, 0, 0, 0.12);
            transition: all linear 0.1s;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
          }
        `;
        const wrapDiv = document.createElement("div");
        wrapDiv.id = "heygen-streaming-embed";
        wrapDiv.classList.add("hide");

        const iframe = document.createElement("iframe");
        iframe.allowFullscreen = true;
        iframe.allow = "microphone";
        iframe.src = url;
        iframe.title = "Streaming Embed";
        iframe.role = "dialog";

        window.addEventListener("message", (e) => {
          if (e.origin === host && e.data && e.data.type === "streaming-embed") {
            const action = e.data.action;
            const visible = action === "show";
            wrapDiv.classList.toggle("expand", visible);
            wrapDiv.classList.toggle("hide", !visible);
          }
        });

        wrapDiv.appendChild(iframe);
        container.appendChild(stylesheet);
        container.appendChild(wrapDiv);
        document.body.appendChild(container);
      }(window);
    </script>
  </body>
</html>
